# ChatMessage 组件宽度优化

## 优化内容

### 扩大机器人回复区域宽度
- ✅ 消息容器从 `max-w-4xl` 调整为 `max-w-6xl`
- ✅ 机器人消息内容从 `max-w-2xl` 调整为 `max-w-4xl`
- ✅ 用户消息保持 `max-w-2xl` 不变
- ✅ 图表预览区域从 `max-w-2xl` 调整为 `max-w-4xl`

### 图表预览默认打开
- ✅ 将 `showDiagram` 初始值从 `false` 改为 `true`
- ✅ 图表预览组件默认展开显示

## 宽度对比

### 优化前
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  用户消息 (max-w-2xl)                                   │
│                                                         │
│  机器人消息 (max-w-2xl)                                 │
│  ┌─────────────────────────────────────────────────────┐ │
│  │ 图表预览 (max-w-2xl)                                │ │
│  └─────────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 优化后
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  用户消息 (max-w-2xl)                                   │
│                                                         │
│  机器人消息 (max-w-4xl)                                 │
│  ┌─────────────────────────────────────────────────────┐ │
│  │ 图表预览 (max-w-4xl) - 默认打开                     │ │
│  └─────────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

## 技术实现

### 主要修改
1. **消息容器宽度**
   ```tsx
   // 从 max-w-4xl 改为 max-w-6xl
   className={cn(
     "flex gap-3 max-w-6xl group",
     message.role === 'user' ? 'ml-auto flex-row-reverse' : 'mr-auto'
   )}
   ```

2. **消息内容宽度**
   ```tsx
   // 机器人消息从 max-w-2xl 改为 max-w-4xl
   <div className={cn(
     "flex flex-col gap-2",
     message.role === 'user' ? 'items-end max-w-2xl' : 'items-start max-w-4xl'
   )}>
   ```

3. **图表预览宽度**
   ```tsx
   // 从 max-w-2xl 改为 max-w-4xl
   <motion.div className="w-full max-w-4xl">
   ```

4. **默认打开图表预览**
   ```tsx
   // 从 false 改为 true
   const [showDiagram, setShowDiagram] = useState(true);
   ```

## 宽度说明

### Tailwind CSS 宽度对比
- `max-w-2xl`: 672px (42rem)
- `max-w-4xl`: 896px (56rem)
- `max-w-6xl`: 1152px (72rem)

### 宽度分配
- 用户消息: 672px (保持原有宽度)
- 机器人消息: 896px (增加 224px)
- 图表预览: 896px (增加 224px)
- 消息容器: 1152px (增加 256px)

## 用户体验提升

### 1. 更大的机器人回复区域
- 长回复有更多水平空间
- 代码块显示更完整
- 减少换行，提高可读性

### 2. 更好的图表预览体验
- 图表有更大的显示空间
- 默认打开，无需手动展开
- 复杂图表显示更清晰

### 3. 保持用户消息的紧凑性
- 用户消息保持原有宽度
- 视觉上更平衡
- 符合聊天应用的设计习惯

## 布局逻辑

### 消息宽度分配
- 用户消息: 较窄，符合用户输入习惯
- 机器人消息: 较宽，便于显示详细回复
- 图表预览: 与机器人消息同宽，保持一致性

### 响应式行为
- 小屏幕: 所有宽度都会适配屏幕
- 中等屏幕: 显示差异明显
- 大屏幕: 充分利用可用空间

## 图表预览优化

### 默认打开的好处
1. 用户无需手动展开
2. 图表内容立即可见
3. 减少交互步骤
4. 提高使用效率

### 保持折叠功能
- 用户仍可以手动折叠
- 节省屏幕空间
- 提供用户控制权

## 测试验证

### 视觉测试
1. 检查机器人消息宽度
2. 验证图表预览默认打开
3. 确认用户消息宽度不变
4. 测试不同屏幕尺寸

### 功能测试
1. 长消息显示测试
2. 图表渲染测试
3. 折叠/展开功能测试
4. 响应式布局测试

### 交互测试
1. 图表预览交互测试
2. 消息操作按钮测试
3. 滚动和布局测试
4. 触摸设备测试
